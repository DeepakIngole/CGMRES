# Introduction
This project provides Continuation/GMRES method (C/GMRES method), a fast algorithm of NMPC, and the multiple shooting based C/GMRES method. In the multiple shooting based C/GMRES method, the computational cost is reduced by condensing the state variables, the Lagrange multiplier of the state equation, the dummy input in the saturation of the control input, and the Lagrange multiplier of the saturation.


# Requirement
- C++11
- Cmake
- Eigen 3
- Python3, numpy, seaborn (for plotsim.py and 2linkanimation.py)
- ffmpeg (to save animations generated by 2linkanimation.py)


# Usage
First, set the parameters of your model of NMPC in nmpc_model.hpp, write equations in nmpc_model.cpp, and set simulation conditions in main.cpp, build files as follows:

```
$ mkdir build
$ cd build
$ cmake ..
$ make
```


After performing a numerical simulation, you can see graphs by

```
$ python3 plotsim.py example
```

save graphs by

```
$ python3 plotsim.py example save example
```

see an animation of 2link robot by

```
$ python3 2linkanimation.py example
```

and save its animation by

```
$ python3 2linkanimation.py example save example
```



# References
1. T. Ohtsuka A continuation/GMRES method for fast computation of nonlinear receding horizon control, Automatica, Vol. 40, No. 4, pp. 563-574 (2004)
2. C. T. Kelly, Iterative methods for linear and nonlinear equations, Frontiers in Apllied Mathematics, SIAM (1995)
3. Y. Shimizu, T. Ohtsuka, M. Diehl, A real‚Äêtime algorithm for nonlinear receding horizon control using multiple shooting and continuation/Krylov method, International Journal of Robust and Nonlinear Control, Vol. 19, No. 8, pp. 919-936 (2008)